{"version":3,"file":"compromise-paragraphs.js","sources":["../src/methods.js","../src/index.js"],"sourcesContent":["const addMethods = function(Paragraphs, Doc) {\n  const methods = {\n    // return back to a regular Doc object\n    sentences: function(n) {\n      let list = []\n      this.paragraphs.forEach(docs => {\n        docs.forEach(doc => {\n          list = list.concat(doc.list)\n        })\n      })\n      let doc = new Doc(list, this.parent, this.world)\n      if (typeof n === 'number') {\n        return doc.eq(n)\n      }\n      return doc\n    },\n\n    // grab every term in the paragraph\n    terms: function(n) {\n      let list = []\n      this.paragraphs.forEach(docs => {\n        docs.forEach(doc => {\n          list = list.concat(doc.terms().list)\n        })\n      })\n      let doc = new Doc(list, this.parent, this.world)\n      if (typeof n === 'number') {\n        return doc.eq(n)\n      }\n      return doc\n    },\n\n    /** return metadata for each paragraph */\n    json: function(options = {}) {\n      return this.paragraphs.map(docs => {\n        let text = docs.map(d => d.text()).join('')\n        let obj = {\n          text: text,\n          sentences: docs.map(d => d.json(options)),\n        }\n        if (options.normal) {\n          obj.normal = docs.map(d => d.text('normal')).join('')\n        }\n        return obj\n      })\n    },\n\n    /** print out the text of each paragraph */\n    text: function(options) {\n      let text = ''\n      this.paragraphs.forEach(docs => {\n        docs.forEach(doc => {\n          text += doc.text(options)\n        })\n      })\n      return text\n    },\n\n    // accessor method wrappers\n    eq: function(n) {\n      let list = [this.paragraphs[n]]\n      list = list.filter(l => l)\n      return new Paragraphs(list, this, this.world)\n    },\n    first: function() {\n      return this.eq(0)\n    },\n    last: function() {\n      let len = this.length\n      return this.eq(len - 1)\n    },\n    debug: function() {\n      this.paragraphs.forEach(docs => {\n        console.log('\\n=-=-=-=-')\n        docs.forEach(doc => {\n          doc.debug()\n        })\n      })\n    },\n\n    // match methods\n\n    // returns doc objects, not paragraph objects\n    match: function(str) {\n      let list = []\n      this.paragraphs.forEach(docs => {\n        docs.forEach(doc => {\n          let m = doc.match(str)\n          if (m.found) {\n            list = list.concat(m.list)\n          }\n        })\n      })\n      return new Doc(list, this.parent, this.world)\n    },\n    // returns doc objects\n    not: function(str) {\n      let list = []\n      this.paragraphs.forEach(docs => {\n        docs.forEach(doc => {\n          let m = doc.not(str)\n          if (m.found) {\n            list = list.concat(m.list)\n          }\n        })\n      })\n      return new Doc(list, this.parent, this.world)\n    },\n    // returns paragraph objects\n    if: function(str) {\n      let list = this.paragraphs.filter(docs => {\n        return docs.some(doc => doc.has(str))\n      })\n      return new Paragraphs(list, this, this.world)\n    },\n    ifNo: function(str) {\n      let list = this.paragraphs.filter(docs => {\n        return docs.some(doc => doc.has(str) === false)\n      })\n      return new Paragraphs(list, this, this.world)\n    },\n    // returns boolean\n    has: function(str) {\n      return this.paragraphs.some(docs => {\n        for (let i = 0; i < docs.length; i++) {\n          return docs[i].has(str)\n        }\n      })\n    },\n\n    //loops\n    forEach: function(fn) {\n      this.paragraphs.forEach(docs => {\n        let p = new Paragraphs([docs], this, this.world)\n        fn(p)\n      })\n      return this\n    },\n    map: function(fn) {\n      let paragraphs = this.paragraphs.map(docs => {\n        let p = new Paragraphs([docs], this, this.world)\n        return fn(p)\n      })\n      new Paragraphs(paragraphs, this, this.world)\n    },\n\n    //each paragraph must have atleast one sentence that matches\n    filter: function(fn) {\n      this.paragraphs = this.paragraphs.filter(docs => {\n        return docs.some(fn)\n      })\n      return this\n    },\n  }\n  // aliases\n  methods.get = methods.eq\n\n  Object.keys(methods).forEach(k => {\n    Paragraphs.prototype[k] = methods[k]\n  })\n}\nmodule.exports = addMethods\n","const hasTwoNewline = /\\n\\n/\nconst wrapperMethods = require('./methods')\n\nconst addMethods = function(Doc) {\n  /** an abstraction on top of Doc */\n  class Paragraphs {\n    constructor(paragraphs, parent, world) {\n      Object.defineProperty(this, 'paragraphs', {\n        enumerable: false,\n        writable: true,\n        value: paragraphs,\n      })\n      this.parent = parent\n      this.world = world\n      //'found' getter\n      Object.defineProperty(this, 'found', {\n        get: () => this.paragraphs.length > 0,\n      })\n      //'length' getter\n      Object.defineProperty(this, 'length', {\n        get: () => this.paragraphs.length,\n      })\n    }\n  }\n  // add our wrapper methods for Doc\n  wrapperMethods(Paragraphs, Doc)\n\n  // finder method creates the sentence groups\n  Doc.prototype.paragraphs = function(n) {\n    let match = this.all()\n    let results = []\n    let carry = []\n    match.forEach(s => {\n      carry.push(s)\n      if (hasTwoNewline.test(s.post()[0])) {\n        results.push(carry)\n        carry = []\n      }\n    })\n    if (carry.length > 0) {\n      results.push(carry)\n    }\n    if (typeof n === 'number') {\n      if (results[n]) {\n        results = [results[n]]\n      } else {\n        results = []\n      }\n    }\n    return new Paragraphs(results, this, this.world)\n  }\n}\n\nmodule.exports = addMethods\n"],"names":["addMethods","Paragraphs","Doc","methods","sentences","n","list","paragraphs","forEach","docs","doc","concat","parent","world","eq","terms","json","options","map","text","d","join","obj","normal","filter","l","first","last","len","length","debug","console","log","match","str","m","found","not","some","has","ifNo","i","fn","p","get","Object","keys","k","prototype","hasTwoNewline","defineProperty","enumerable","writable","value","wrapperMethods","all","results","carry","s","push","test","post"],"mappings":"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"}