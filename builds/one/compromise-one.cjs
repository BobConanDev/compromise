var t,e;t=this,e=function(){var t={methods:{one:{},two:{},three:{},four:{}},model:{one:{},two:{},three:{}},compute:{},hooks:[]},e={compute:function(t){const{world:e}=this,n=e.compute;return"string"==typeof t&&n.hasOwnProperty(t)?n[t](this):(t=>"[object Array]"===Object.prototype.toString.call(t))(t)?t.forEach(t=>e.compute.hasOwnProperty(t)&&n[t](this)):"function"==typeof t?t(this):console.warn("no compute:",t),this}},n={forEach:function(t){return this.fullPointer.forEach((e,n)=>{let r=this.update([e]);t(r,n)}),this},map:function(t,e){let n=this.fullPointer.map((e,n)=>{let r=this.update([e]);return t(r,n)});if(0===n.length)return e||this.update([]);if(void 0!==n[0]&&"object"==typeof n[0]&&(null===n[0]||!n[0].isView))return n;let r=[];return n.forEach(t=>{r=r.concat(t.fullPointer)}),this.toView(r)},filter:function(t){let e=this.fullPointer;return e=e.filter((e,n)=>{let r=this.update([e]);return t(r,n)}),this.update(e)},find:function(t){let e=this.fullPointer.find((e,n)=>{let r=this.update([e]);return t(r,n)});return this.update([e])},some:function(t){return this.fullPointer.some((e,n)=>{let r=this.update([e]);return t(r,n)})},random:function(t=1){let e=this.fullPointer,n=Math.floor(Math.random()*e.length);return n+t>this.length&&(n=this.length-t,n=n<0?0:n),e=e.slice(n,n+t),this.update(e)}};const r={termList:function(){return this.methods.one.termList(this.docs)},terms:function(t){let e=this.match(".").toView();return"number"==typeof t?e.eq(t):e},groups:function(t){if(t||0===t)return this.update(this._groups[t]||[]);let e={};return Object.keys(this._groups).forEach(t=>{e[t]=this.update(this._groups[t])}),e},eq:function(t){let e=this.pointer;return e||(e=this.docs.map((t,e)=>[e])),e[t]?this.update([e[t]]):this.none()},first:function(){return this.eq(0)},last:function(){let t=this.fullPointer.length-1;return this.eq(t)},firstTerms:function(){return this.match("^.")},lastTerms:function(){return this.match(".$")},slice:function(t,e){let n=this.pointer||this.docs.map((t,e)=>[e]);return n=n.slice(t,e),this.update(n)},all:function(){return this.update().toView()},fullSentences:function(){let t=this.fullPointer.map(t=>[t[0]]);return this.update(t).toView()},none:function(){return this.update([])},is:function(t){if(!t||!t.isView)return!1;let e=this.fullPointer,n=t.fullPointer;return!e.length!==n.length&&e.every((t,e)=>!!n[e]&&t[0]===n[e][0]&&t[1]===n[e][1]&&t[2]===n[e][2])},wordCount:function(){return this.docs.reduce((t,e)=>t+=e.filter(t=>""!==t.text).length,0)}};r.group=r.groups,r.fullSentence=r.fullSentences,r.sentence=r.fullSentences,r.lastTerm=r.lastTerms,r.firstTerm=r.firstTerms;var o=r,s={freeze:function(){return this.frozen=this.docs,this},unfreeze:function(){return this.frozen=null,this}};const i=Object.assign({},o,e,n,s);i.get=i.eq;var l=i;class View{constructor(e,n,r={}){[["document",e],["world",t],["_groups",r],["_cache",null],["viewType","View"]].forEach(t=>{Object.defineProperty(this,t[0],{value:t[1],writable:!0})}),this.ptrs=n}get docs(){let e=this.document;return this.frozen?this.frozen:(this.ptrs&&(e=t.methods.one.getDoc(this.ptrs,this.document)),e)}get pointer(){return this.ptrs}get methods(){return this.world.methods}get model(){return this.world.model}get hooks(){return this.world.hooks}get isView(){return!0}get found(){return this.docs.length>0}get length(){return this.docs.length}get fullPointer(){let{docs:t,ptrs:e,document:n,frozen:r}=this;return r?function(t){const{methods:e,frozen:n,ptrs:r,document:o}=t;return e.one.pointerFromTerms(n)}(this):(e||t.map((t,e)=>[e])).map(t=>((t=t.slice(0))[1]=t[1]||0,t[2]=t[2]||(n[t[0]]||[]).length,t))}update(t){let e=new View(this.document,t);if(e._cache&&t&&t.length>1){let n=[];t.forEach(t=>{1===t.length&&n.push(e._cache[t[0]])}),e._cache=n}return e.world=this.world,e}toView(t){return void 0===t&&(t=this.pointer),new View(this.document,t)}clone(){let t=this.document.slice(0);t=t.map(t=>t.map(t=>((t=Object.assign({},t)).tags=new Set(t.tags),t)));let e=this.update(this.pointer);return e.document=t,e._cache=this._cache,e}}Object.assign(View.prototype,l);var c=View;const u=function(t){return t&&"object"==typeof t&&!Array.isArray(t)};var a=function(t,e,n,r){const{methods:o,model:s,compute:i,hooks:l}=e;t.methods&&function(t,e){for(const n in e)t[n]=t[n]||{},Object.assign(t[n],e[n])}(o,t.methods),t.model&&function t(e,n){if(u(n))for(const r in n)u(n[r])?(e[r]||Object.assign(e,{[r]:{}}),t(e[r],n[r])):Object.assign(e,{[r]:n[r]});return e}(s,t.model),t.compute&&Object.assign(i,t.compute),l&&(e.hooks=l.concat(t.hooks||[])),t.api&&t.api(n),t.lib&&Object.keys(t.lib).forEach(e=>r[e]=t.lib[e]),t.tags&&r.addTags(t.tags),t.words&&r.addWords(t.words)};const h=t=>t instanceof Set,f=function(t){for(const r in t)(n=t[r])&&"object"==typeof n&&!Array.isArray(n)?(t[r]=Object.assign({},t[r]),t[r]=f(t[r])):(e=t[r],"[object Array]"===Object.prototype.toString.call(e)?t[r]=t[r].slice(0):h(t[r])&&(t[r]=new Set(t[r])));var e,n;return t};var p=f;let d=Object.assign({},t);const m=function(t,e){const{methods:n,hooks:r}=d;e&&m.addWords(e);let o=n.one.tokenize(t,d),s=new c(o);return s.world=d,s.compute(r),s};Object.defineProperty(m,"_world",{value:d,writable:!0}),m.tokenize=function(t,e){const{methods:n,compute:r}=this._world;e&&m.addWords(e);let o=n.one.tokenize(t,this._world),s=new c(o);return r.contractions&&s.compute(["alias","normal","machine","contractions"]),s},m.fork=function(t){return this._world=Object.assign({},this._world),this._world.methods=Object.assign({},this._world.methods),this._world.model=p(this._world.model),this._world.model.fork=t,this},m.plugin=function(t){return a(t,this._world,c,this),this},m.extend=m.plugin,m.verbose=function(t){let e="undefined"==typeof process?self.env||{}:process.env;return e.DEBUG_TAGS="tagger"===t||!0===t||"",e.DEBUG_MATCH="match"===t||!0===t||"",e.DEBUG_CHUNKS="chunker"===t||!0===t||"",this},m.compile=function(t){return this().compile(t)},m.version="14rc",m.world=function(){return this._world},m.model=function(){return this._world.model},m.methods=function(){return this._world.methods},m.hooks=function(){return this._world.hooks};var y=m;const b=(t,e,n)=>{let r=[e,0].concat(n);return Array.prototype.splice.apply(t,r),t},w=function(t){let e=t[t.length-1];!e||/ $/.test(e.post)||/[-–—]/.test(e.post)||(e.post+=" ")},v=(t,e,n)=>{const r=/[.?!,;:)-–—'"]/g;let o=t[e-1];if(!o)return;let s=o.post;if(r.test(s)){let t=s.match(r).join(""),e=n[n.length-1];e.post=t+e.post,o.post=o.post.replace(r,"")}},x=function(t){return/^[A-Z][a-z'\u00C0-\u00FF]/.test(t)||/^[A-Z]$/.test(t)},j=function(t,e,n,r){let[o,s,i]=e;0===s||i===r[o].length?w(n):(w(n),w([t[e[1]]])),function(t,e,n){let r=t[e];if(0!==e||!x(r.text))return;n[0].text=n[0].text.replace(/^[a-z\u00C0-\u00FF]/,t=>t.toUpperCase());let o=t[e];o.tags.has("ProperNoun")||o.tags.has("Acronym")||x(o.text)&&o.text.length>1&&(o.text=o.text.replace(/^[A-Z]/,t=>t.toLowerCase()))}(t,s,n),v(t,i,n),b(t,s,n)},E=function(t,e,n){const{methods:r,document:o,world:s}=e;let i=e.fullPointer,l=e.fullPointer;e.has("@hasContraction")&&e.grow("@hasContraction").contractions().expand(),i.forEach((e,i)=>{let[c]=e,u=o[c],a=[];"string"==typeof t?a=r.one.tokenize(t,s)[0]:"object"==typeof t&&t.docs&&(a=t.docs[0]),n?j(u,e,a,o):function(t,e,n,r){let[o,,s]=e,i=r[o].length;s<i?(v(t,s,n),w(n)):i===s&&(w(t),v(t,s,n)),b(t,e[2],n)}(u,e,a,o),l[i]=e,e[2]+=a.length});let c=e.toView(i);return e.ptrs=l,c.compute(["index","lexicon","preTagger"]),c},O={insertAfter:function(t){return E(t,this,!1)},insertBefore:function(t){return E(t,this,!0)},concat:function(t){const{methods:e,document:n,world:r}=this;if("string"==typeof t){let o=e.one.tokenize(t,r),s=this.fullPointer,i=s[s.length-1][0];return b(n,i+1,o),this.compute("index")}if(this.document===t.document){let e=this.fullPointer.concat(t.fullPointer);return this.toView(e).compute("index")}return this}};O.append=O.insertAfter,O.prepend=O.insertBefore,O.insert=O.insertAfter;var _=O;const k={replaceWith:function(t){let e=this.fullPointer;this.insertAfter(t);let n=this.update(e);return n.has("@hasContraction")&&this.growLeft("@hasContraction+").growRight("@hasContraction+").contractions().expand(),this.delete(n),this.toView(e).compute(["index","lexicon","preTagger"])},replace:function(t,e){if(t&&!e)return this.replaceWith(t);let n=this.match(t);return n.found?n.replaceWith(e):this}};var P=k;const A={remove:function(t){const{indexN:e}=this.methods.one;let n=this.all(),r=this;t&&(n=this,r=this.match(t)),n.has("@hasContraction")&&n.grow("@hasContraction").contractions().expand();let o=n.fullPointer,s=r.fullPointer.reverse(),i=function(t,e){e.forEach(e=>{let[n,r,o]=e,s=o-r;t[n]&&(o===t[n].length&&o>1&&function(t,e){let n=t.length-1,r=t[n],o=t[n-e];o&&r&&(o.post+=r.post,o.post=o.post.replace(/ +([.?!,;:])/,"$1"),o.post=o.post.replace(/[,;:]+([.?!])/,"$1"))}(t[n],s),t[n].splice(r,s))});for(let e=t.length-1;e>=0;e-=1)if(0===t[e].length&&(t.splice(e,1),e===t.length&&t[e-1])){let n=t[e-1],r=n[n.length-1];r&&(r.post=r.post.trimEnd())}return t}(this.document,s),l=e(s);return o=o.map(t=>{let[e]=t;return l[e]?(l[e].forEach(e=>{let n=e[2]-e[1];t[1]<=e[1]&&t[2]>=e[2]&&(t[2]-=n)}),t):t}),o=o.filter((t,e)=>{if(t[2]-t[1]<=0){for(let t=e+1;t<o.length;t+=1)o[t][0]-=1;return!1}return!0}),n.ptrs=o,n.document=i,n.toView(o).compute("index")}};A.delete=A.remove;var z=A;const S={pre:function(t,e){return void 0===t&&this.found?this.docs[0][0].pre:(this.docs.forEach(n=>{let r=n[0];!0===e?r.pre+=t:r.pre=t}),this)},post:function(t,e){if(void 0===t){let t=this.docs[this.docs.length-1];return t[t.length-1].post}return this.docs.forEach(n=>{let r=n[n.length-1];!0===e?r.post+=t:r.post=t}),this},trim:function(){if(!this.found)return this;let t=this.docs,e=t[0][0];e.pre=e.pre.trimStart();let n=t[t.length-1],r=n[n.length-1];return r.post=r.post.trimEnd(),this},hyphenate:function(){return this.docs.forEach(t=>{t.forEach((e,n)=>{0!==n&&(e.pre=""),t[n+1]&&(e.post="-")})}),this},dehyphenate:function(){const t=/[-–—]/;return this.docs.forEach(e=>{e.forEach(e=>{t.test(e.post)&&(e.post=" ")})}),this},toQuotations:function(t,e){return t=t||'"',e=e||'"',this.docs.forEach(n=>{n[0].pre=t+n[0].pre;let r=n[n.length-1];r.post=e+r.post}),this},toParentheses:function(t,e){return t=t||"(",e=e||")",this.docs.forEach(n=>{n[0].pre=t+n[0].pre;let r=n[n.length-1];r.post=e+r.post}),this}};S.deHyphenate=S.dehyphenate,S.toQuotation=S.toQuotations;var C=S,$={alpha:(t,e)=>t.normal<e.normal?-1:t.normal>e.normal?1:0,length:(t,e)=>{let n=t.normal.trim().length,r=e.normal.trim().length;return n<r?1:n>r?-1:0},wordCount:(t,e)=>t.words<e.words?1:t.words>e.words?-1:0,sequential:(t,e)=>{let n=t.pointer.join(""),r=e.pointer.join("");return n<r?1:n>r?-1:0},byFreq:function(t){let e={};return t.forEach(t=>{e[t.normal]=e[t.normal]||0,e[t.normal]+=1}),t.sort((t,n)=>{let r=e[t.normal],o=e[n.normal];return r<o?1:r>o?-1:0}),t}};const F=new Set(["index","sequence","seq","sequential","chron","chronological"]),T=new Set(["freq","frequency","topk","repeats"]);var B={unique:function(){let t=new Set;return this.filter(e=>{let n=e.text("normal");return!t.has(n)&&(t.add(n),!0)})},reverse:function(){let t=this.pointer||this.docs.map((t,e)=>[e]);return t=[].concat(t),t=t.reverse(),this.update(t)},sort:function(t){let{docs:e,pointer:n}=this;t=t||"alpha";let r=n||e.map((t,e)=>[e]),o=e.map((t,e)=>({index:e,words:t.length,normal:t.map(t=>t.machine||t.normal||"").join(" "),pointer:r[e]}));return F.has(t)&&(t="sequential"),T.has(t)?(o=$.byFreq(o),this.update(o.map(t=>t.pointer))):"function"==typeof $[t]?(o=o.sort($[t]),this.update(o.map(t=>t.pointer))):this}},q={fork:function(){let t=this;var e;return t.world.model=(e=t.world.model,JSON.parse(JSON.stringify(e))),t.world.methods=Object.assign({},t.world.methods),t.ptrs&&(t.ptrs=t.ptrs.slice(0)),t}};const D=Object.assign({},{toLowerCase:function(){return this.termList().forEach(t=>{t.text=t.text.toLowerCase()}),this},toUpperCase:function(){return this.termList().forEach(t=>{t.text=t.text.toUpperCase()}),this},toTitleCase:function(){return this.termList().forEach(t=>{t.text=t.text.replace(/^ *[a-z\u00C0-\u00FF]/,t=>t.toUpperCase())}),this},toCamelCase:function(){return this.docs.forEach(t=>{t.forEach((e,n)=>{0!==n&&(e.text=e.text.replace(/^ *[a-z\u00C0-\u00FF]/,t=>t.toUpperCase())),n!==t.length-1&&(e.post="")})}),this}},_,P,z,C,B,q);var V={api:function(t){Object.assign(t.prototype,D)}};const N=function(t,e){return e?(t.forEach(t=>{let n=t[0];e[n]&&(t[0]=e[n][0],t[1]+=e[n][1],t[2]+=e[n][1])}),t):t},G=function(t,e){let{ptrs:n,byGroup:r}=t;return n=N(n,e),Object.keys(r).forEach(t=>{r[t]=N(r[t],e)}),{ptrs:n,byGroup:r}},L=t=>t&&"object"==typeof t&&!0===t.isView;var M={matchOne:function(t,e){const n=this.methods.one;if(L(t))return this.intersection(t).eq(0);"string"==typeof t&&(t=n.parseMatch(t));let r={regs:t,group:e,justOne:!0},o=n.match(this.docs,r,this._cache),{ptrs:s,byGroup:i}=G(o,this.fullPointer),l=this.toView(s);return l._groups=i,l},match:function(t,e){const n=this.methods.one;if(L(t))return this.intersection(t);"string"==typeof t&&(t=n.parseMatch(t));let r={regs:t,group:e},o=n.match(this.docs,r,this._cache),{ptrs:s,byGroup:i}=G(o,this.fullPointer),l=this.toView(s);return l._groups=i,l},has:function(t,e){const n=this.methods.one;let r;if("string"==typeof t){let o={regs:t=n.parseMatch(t),group:e,justOne:!0};r=n.match(this.docs,o,this._cache).ptrs}else L(t)&&(r=t.fullPointer);return r.length>0},if:function(t,e){const n=this.methods.one;if("string"==typeof t){let r={regs:t=n.parseMatch(t),group:e,justOne:!0},o=this.fullPointer;return o=o.filter(t=>{let e=this.update([t]);return n.match(e.docs,r,this._cache).ptrs.length>0}),this.update(o)}return L(t)?this.intersection(t):this.none()},ifNo:function(t,e){const{methods:n}=this,r=n.one;return L(t)?this.difference(t):("string"==typeof t&&(t=r.parseMatch(t)),this.filter(n=>{let o={regs:t,group:e,justOne:!0};return 0===r.match(n.docs,o,n._cache).ptrs.length}))}},U={before:function(t,e){const{indexN:n}=this.methods.one;let r=[],o=n(this.fullPointer);Object.keys(o).forEach(t=>{let e=o[t].sort((t,e)=>t[1]>e[1]?1:-1)[0];e[1]>0&&r.push([e[0],0,e[1]])});let s=this.toView(r);return t?s.match(t,e):s},after:function(t,e){const{indexN:n}=this.methods.one;let r=[],o=n(this.fullPointer),s=this.document;Object.keys(o).forEach(t=>{let e=o[t].sort((t,e)=>t[1]>e[1]?-1:1)[0],[n,,i]=e;i<s[n].length&&r.push([n,i,s[n].length])});let i=this.toView(r);return t?i.match(t,e):i},growLeft:function(t,e){(t=this.world.methods.one.parseMatch(t))[t.length-1].end=!0;let n=this.fullPointer;return this.forEach((r,o)=>{let s=r.before(t,e);s.found&&(n[o][1]-=s.terms().length)}),this.update(n)},growRight:function(t,e){(t=this.world.methods.one.parseMatch(t))[0].start=!0;let n=this.fullPointer;return this.forEach((r,o)=>{let s=r.after(t,e);s.found&&(n[o][2]+=s.terms().length)}),this.update(n)},grow:function(t,e){return this.growRight(t,e).growLeft(t,e)}};const W=function(t,e){return[t[0],t[1],e[2]]},Z=(t,e,n)=>{let r=t;return"string"==typeof t&&(r=e.match(t,n)),r},Q={splitOn:function(t,e){const{splitAll:n}=this.methods.one;let r=Z(t,this,e).fullPointer,o=n(this.fullPointer,r),s=[];return o.forEach(t=>{s.push(t.passthrough),s.push(t.before),s.push(t.match),s.push(t.after)}),s=s.filter(t=>t),this.update(s)},splitBefore:function(t,e){const{splitAll:n}=this.methods.one;let r=Z(t,this,e).fullPointer,o=n(this.fullPointer,r),s=[];return o.forEach(t=>{s.push(t.passthrough),s.push(t.before),t.match&&t.after?s.push(W(t.match,t.after)):(s.push(t.match),s.push(t.after))}),s=s.filter(t=>t),this.update(s)},splitAfter:function(t,e){const{splitAll:n}=this.methods.one;let r=Z(t,this,e).fullPointer,o=n(this.fullPointer,r),s=[];return o.forEach(t=>{s.push(t.passthrough),t.before&&t.match?s.push(W(t.before,t.match)):(s.push(t.before),s.push(t.match)),s.push(t.after)}),s=s.filter(t=>t),this.update(s)}};Q.split=Q.splitAfter;var H=Q;const R=Object.assign({},M,U,H);R.lookBehind=R.before,R.lookBefore=R.before,R.lookAhead=R.after,R.lookAfter=R.after,R.notIf=R.ifNo;var I=function(t){Object.assign(t.prototype,R)};const J=/(?:^|\s)([![^]*(?:<[^<]*>)?\/.*?[^\\/]\/[?\]+*$~]*)(?:\s|$)/,K=/([![^]*(?:<[^<]*>)?\([^)]+[^\\)]\)[?\]+*$~]*)(?:\s|$)/,X=/ /g,Y=t=>/^[![^]*(<[^<]*>)?\//.test(t)&&/\/[?\]+*$~]*$/.test(t),tt=function(t){return t=(t=t.map(t=>t.trim())).filter(t=>t)};var et=function(t){let e=t.split(J),n=[];e.forEach(t=>{Y(t)?n.push(t):n=n.concat(t.split(K))}),n=tt(n);let r=[];return n.forEach(t=>{(t=>/^[![^]*(<[^<]*>)?\(/.test(t)&&/\)[?\]+*$~]*$/.test(t))(t)||Y(t)?r.push(t):r=r.concat(t.split(X))}),r=tt(r),r};const nt=/\{([0-9]+)(, *[0-9]*)?\}/,rt=/&&/,ot=new RegExp(/^<\s*(\S+)\s*>/),st=t=>t.charAt(0).toUpperCase()+t.substr(1),it=function(t){return t[t.length-1]},lt=function(t){return t[0]},ct=function(t){return t.substr(1)},ut=function(t){return t.substr(0,t.length-1)},at=function(t){return t=ct(t),t=ut(t)},ht=function(t){let e={};for(let n=0;n<2;n+=1){if("$"===it(t)&&(e.end=!0,t=ut(t)),"^"===lt(t)&&(e.start=!0,t=ct(t)),("["===lt(t)||"]"===it(t))&&(e.group=null,"["===lt(t)&&(e.groupStart=!0),"]"===it(t)&&(e.groupEnd=!0),t=(t=t.replace(/^\[/,"")).replace(/\]$/,""),"<"===lt(t))){const n=ot.exec(t);n.length>=2&&(e.group=n[1],t=t.replace(n[0],""))}if("+"===it(t)&&(e.greedy=!0,t=ut(t)),"*"!==t&&"*"===it(t)&&"\\*"!==t&&(e.greedy=!0,t=ut(t)),"?"===it(t)&&(e.optional=!0,t=ut(t)),"!"===lt(t)&&(e.negative=!0,t=ct(t)),"("===lt(t)&&")"===it(t)){rt.test(t)?(e.choices=t.split(rt),e.operator="and"):(e.choices=t.split("|"),e.operator="or"),e.choices[0]=ct(e.choices[0]);let n=e.choices.length-1;e.choices[n]=ut(e.choices[n]),e.choices=e.choices.map(t=>t.trim()),e.choices=e.choices.filter(t=>t),e.choices=e.choices.map(t=>t.split(/ /g).map(ht)),t=""}if("/"===lt(t)&&"/"===it(t))return t=at(t),e.regex=new RegExp(t),e;if("~"===lt(t)&&"~"===it(t))return t=at(t),e.soft=!0,e.word=t,e;if("{"===lt(t)&&"}"===it(t))return t=at(t),/\//.test(t)?(e.sense=t,e.greedy=!0):e.machine=t,e;if("<"===lt(t)&&">"===it(t))return t=at(t),e.chunk=st(t),e.greedy=!0,e}return!0===nt.test(t)&&(t=t.replace(nt,(t,n,r)=>(void 0===r?(e.min=Number(n),e.max=Number(n)):(r=r.replace(/, */,""),e.min=Number(n),e.max=Number(r||999)),e.greedy=!0,e.optional=!0,""))),"#"===lt(t)?(e.tag=ct(t),e.tag=st(e.tag),e):"@"===lt(t)?(e.method=ct(t),e):"."===t?(e.anything=!0,e):"*"===t?(e.anything=!0,e.greedy=!0,e.optional=!0,e):(t&&(t=(t=t.replace("\\*","*")).replace("\\.","."),e.word=t.toLowerCase()),e)};var ft=ht,pt=function(t,e={}){return t=function(t){let e=0,n=null;for(let r=0;r<t.length;r++){const o=t[r];!0===o.groupStart&&(n=o.group,null===n&&(n=String(e),e+=1)),null!==n&&(o.group=n),!0===o.groupEnd&&(n=null)}return t}(t),e.fuzzy||(t=t.map(t=>{if(void 0!==t.choices){if("or"!==t.operator)return t;!0===t.choices.every(t=>{if(1!==t.length)return!1;let e=t[0];return!e.start&&!e.end&&void 0!==e.word&&!0!==e.negative&&!0!==e.optional&&!0!==e.method})&&(t.fastOr=new Set,t.choices.forEach(e=>{t.fastOr.add(e[0].word)}),delete t.choices)}return t})),t},dt=function(t,e={}){if(null==t||""===t)return[];"number"==typeof t&&(t=String(t));let n=et(t);return n=n.map(t=>ft(t,e)),n=pt(n,e),n=function(t,e){return!0===e.fuzzy&&(e.fuzzy=.85),"number"==typeof e.fuzzy&&(t=t.map(t=>(e.fuzzy>0&&t.word&&(t.fuzzy=e.fuzzy),t.choices&&t.choices.forEach(t=>{t.forEach(t=>{t.fuzzy=e.fuzzy})}),t))),t}(n,e),n};const gt=function(t,e){for(let n of e)if(t.has(n))return!0;return!1};var mt=function(t,e){for(let n=0;n<t.length;n+=1){let r=t[n];if(!0!==r.optional&&!0!==r.negation){if(void 0!==r.word&&!1===e.has(r.word))return!0;if(void 0!==r.tag&&!1===e.has("#"+r.tag))return!0;if(r.fastOr&&!1===gt(r.fastOr,e))return!1}}return!1},yt=function(t,e,n=3){if(t===e)return 1;if(t.length<n||e.length<n)return 0;const r=function(t,e){let n=t.length,r=e.length;if(0===n)return r;if(0===r)return n;let o=(r>n?r:n)+1;if(Math.abs(n-r)>(o||100))return o||100;let s,i,l,c,u,a,h=[];for(let t=0;t<o;t++)h[t]=[t],h[t].length=o;for(let t=0;t<o;t++)h[0][t]=t;for(let o=1;o<=n;++o)for(i=t[o-1],s=1;s<=r;++s){if(o===s&&h[o][s]>4)return n;l=e[s-1],c=i===l?0:1,u=h[o-1][s]+1,(a=h[o][s-1]+1)<u&&(u=a),(a=h[o-1][s-1]+c)<u&&(u=a);let r=o>1&&s>1&&i===e[s-2]&&t[o-2]===l&&(a=h[o-2][s-2]+c)<u;h[o][s]=r?a:u}return h[n][r]}(t,e);let o=Math.max(t.length,e.length);return 1-(0===o?0:r/o)};const bt=/([\u0022\uFF02\u0027\u201C\u2018\u201F\u201B\u201E\u2E42\u201A\u00AB\u2039\u2035\u2036\u2037\u301D\u0060\u301F])/,wt=/([\u0022\uFF02\u0027\u201D\u2019\u00BB\u203A\u2032\u2033\u2034\u301E\u00B4])/,vt=/^[-–—]$/,xt=/ [-–—] /,jt=(t,e)=>-1!==t.post.indexOf(e),Et=(t,e)=>-1!==t.pre.indexOf(e),Ot={hasQuote:t=>bt.test(t.pre)||wt.test(t.post),hasComma:t=>jt(t,","),hasPeriod:t=>!0===jt(t,".")&&!1===jt(t,"..."),hasExclamation:t=>jt(t,"!"),hasQuestionMark:t=>jt(t,"?")||jt(t,"¿"),hasEllipses:t=>jt(t,"..")||jt(t,"…")||Et(t,"..")||Et(t,"…"),hasSemicolon:t=>jt(t,";"),hasSlash:t=>/\//.test(t.text),hasHyphen:t=>vt.test(t.post)||vt.test(t.pre),hasDash:t=>xt.test(t.post)||xt.test(t.pre),hasContraction:t=>Boolean(t.implicit),isAcronym:t=>t.tags.has("Acronym"),isKnown:t=>t.tags.size>0,isTitleCase:t=>/^[A-Z][a-z'\u00C0-\u00FF]/.test(t.text)};Ot.hasQuotation=Ot.hasQuote;var _t=Ot;let kt=function(){};kt=function(t,e,n,r){let o=function(t,e,n,r){if(!0===e.anything)return!0;if(!0===e.start&&0!==n)return!1;if(!0===e.end&&n!==r-1)return!1;if(void 0!==e.word){if(null!==t.machine&&t.machine===e.word)return!0;if(void 0!==t.alias&&t.alias.hasOwnProperty(e.word))return!0;if(!0===e.soft&&e.word===t.root)return!0;if(void 0!==e.fuzzy){let n=yt(e.word,t.normal);if(n>e.fuzzy)return!0;if(!0===e.soft&&(n=yt(e.word,t.root),n>e.fuzzy))return!0}return!(!t.alias||!t.alias.some(t=>t===e.word))||e.word===t.text||e.word===t.normal}return void 0!==e.tag?!0===t.tags.has(e.tag):void 0!==e.method?"function"==typeof _t[e.method]&&!0===_t[e.method](t):void 0!==e.pre?t.pre&&t.pre.includes(e.pre):void 0!==e.post?t.post&&t.post.includes(e.post):void 0!==e.regex?e.regex.test(t.normal):void 0!==e.chunk?t.chunk===e.chunk:void 0!==e.machine?t.normal===e.machine||t.machine===e.machine:void 0!==e.sense?t.sense===e.sense:void 0!==e.fastOr?!(!t.implicit||!0!==e.fastOr.has(t.implicit))||e.fastOr.has(t.normal)||e.fastOr.has(t.text):void 0!==e.choices&&("and"===e.operator?e.choices.every(e=>kt(t,e,n,r)):e.choices.some(e=>kt(t,e,n,r)))}(t,e,n,r);return!0===e.negative?!o:o};var Pt=kt;const At="undefined"==typeof process?self.env||{}:process.env,zt=t=>{At.DEBUG_MATCH&&console.log(`\n  [32m ${t} [0m`)},St=function(t,e){let n=Object.assign({},t.regs[t.r],{start:!1,end:!1}),r=t.t;for(;t.t<t.terms.length;t.t+=1){if(e&&Pt(t.terms[t.t],e,t.start_i+t.t,t.phrase_length))return t.t;let o=t.t-r+1;if(void 0!==n.max&&o===n.max)return t.t;if(!1===Pt(t.terms[t.t],n,t.start_i+t.t,t.phrase_length))return void 0!==n.min&&o<n.min?null:t.t}return t.t},Ct=function(t,e){let n=t.t;if(!e)return t.terms.length;for(;n<t.terms.length;n+=1)if(!0===Pt(t.terms[n],e,t.start_i+n,t.phrase_length))return zt("greedyTo "+t.terms[n].normal),n;return null},$t=function(t,e){if(!0===t.end&&!0===t.greedy&&e.start_i+e.t<e.phrase_length-1){let n=Object.assign({},t,{end:!1});if(!0===Pt(e.terms[e.t],n,e.start_i+e.t,e.phrase_length))return zt("endGreedy "+e.terms[e.t].normal),!0}return!1},Ft=function(t,e=0){let n=t.regs[t.r],r=!1;for(let o=0;o<n.choices.length;o+=1){let s=n.choices[o];if(r=s.every((n,r)=>{let o=0,s=t.t+r+e+o;if(void 0===t.terms[s])return!1;let i=Pt(t.terms[s],n,s+t.start_i,t.phrase_length);if(!0===i&&!0===n.greedy)for(let e=1;e<t.terms.length;e+=1){let r=t.terms[s+e];if(r){if(!0!==Pt(r,n,t.start_i+e,t.phrase_length))break;o+=1}}return e+=o,i}),r){e+=s.length;break}}return r&&!0===n.greedy?Ft(t,e):e},Tt=function(t){let e=0;return!0===t.regs[t.r].choices.every(n=>{let r=n.every((e,n)=>{let r=t.t+n;return void 0!==t.terms[r]&&Pt(t.terms[r],e,r,t.phrase_length)});return!0===r&&n.length>e&&(e=n.length),r})&&(zt("doAndBlock "+t.terms[t.t].normal),e)},Bt=function(t,e){return t.groups[t.inGroup]||(t.groups[t.inGroup]={start:e,length:0}),t.groups[t.inGroup]};var qt=function(t,e,n,r){if(0===t.length||0===e.length)return null;let o={t:0,terms:t,r:0,regs:e,groups:{},start_i:n,phrase_length:r,inGroup:null};for(;o.r<e.length;o.r+=1){let t=e[o.r];if(o.hasGroup=Boolean(t.group),!0===o.hasGroup?o.inGroup=t.group:o.inGroup=null,!o.terms[o.t]){if(!1===e.slice(o.r).some(t=>!t.optional))break;return null}if(!0===t.anything&&!0===t.greedy){let n=Ct(o,e[o.r+1]);if(null===n||0===n)return null;if(void 0!==t.min&&n-o.t<t.min)return null;if(void 0!==t.max&&n-o.t>t.max){o.t=o.t+t.max;continue}!0===o.hasGroup&&(Bt(o,o.t).length=n-o.t),o.t=n;continue}if(void 0!==t.choices&&"or"===t.operator){let e=Ft(o);if(e){if(!0===t.negative)return null;if(!0===o.hasGroup&&(Bt(o,o.t).length+=e),!0===t.end){let t=o.phrase_length-1;if(o.t+o.start_i!==t)return null}o.t+=e;continue}if(!t.optional)return null}if(void 0!==t.choices&&"and"===t.operator){let e=Tt(o);if(e){if(!0===t.negative)return null;if(!0===o.hasGroup&&(Bt(o,o.t).length+=e),!0===t.end){let t=o.phrase_length-1;if(o.t+o.start_i!==t)return null}o.t+=e;continue}if(!t.optional)return null}let n=o.terms[o.t],s=Pt(n,t,o.start_i+o.t,o.phrase_length);if(!0===t.anything||!0===s||$t(t,o)){let s=o.t;if(t.optional&&e[o.r+1]&&t.negative)continue;if(t.optional&&e[o.r+1]){let r=Pt(n,e[o.r+1],o.start_i+o.t,o.phrase_length);if(t.negative||r){let t=o.terms[o.t+1];t&&Pt(t,e[o.r+1],o.start_i+o.t,o.phrase_length)||(o.r+=1)}}if(o.t+=1,!0===t.end&&o.t!==o.terms.length&&!0!==t.greedy)return null;if(!0===t.greedy){if(o.t=St(o,e[o.r+1]),null===o.t)return null;if(t.min&&t.min>o.t)return null;if(!0===t.end&&o.start_i+o.t!==r)return null}if(!0===o.hasGroup){const e=Bt(o,s);o.t>1&&t.greedy?e.length+=o.t-s:e.length++}}else{if(t.negative){let e=Object.assign({},t);if(e.negative=!1,!0===Pt(o.terms[o.t],e,o.start_i+o.t,o.phrase_length))return null}if(!0!==t.optional){if(Boolean(o.terms[o.t].implicit)&&e[o.r-1]&&o.terms[o.t+1]){if(o.terms[o.t-1]&&o.terms[o.t-1].implicit===e[o.r-1].word)return null;if(Pt(o.terms[o.t+1],t,o.start_i+o.t,o.phrase_length)){o.t+=2;continue}}return null}}}let s=[null,n,o.t+n];if(s[1]===s[2])return null;let i={};return Object.keys(o.groups).forEach(t=>{let e=o.groups[t],r=n+e.start;i[t]=[null,r,r+e.length]}),{pointer:s,groups:i}},Dt=function(t,e){let n=[],r={};return 0===t.length||("number"==typeof e&&(e=String(e)),e?t.forEach(t=>{t.groups[e]&&n.push(t.groups[e])}):t.forEach(t=>{n.push(t.pointer),Object.keys(t.groups).forEach(e=>{r[e]=r[e]||[],r[e].push(t.groups[e])})})),{ptrs:n,byGroup:r}};const Vt=function(t,e){return t.pointer[0]=e,Object.keys(t.groups).forEach(n=>{t.groups[n][0]=e}),t},Nt=function(t,e,n){let r=qt(t,e,0,t.length);return r?(r=Vt(r,n),r):null};var Gt={api:I,methods:{one:{termMethods:_t,parseMatch:dt,match:function(t,e,n){n=n||[];let{regs:r,group:o,justOne:s}=e,i=[];if(!r||0===r.length)return{ptrs:[],byGroup:{}};const l=r.filter(t=>!0!==t.optional&&!0!==t.negative).length;t:for(let e=0;e<t.length;e+=1){let o=t[e];if(!n[e]||!mt(r,n[e]))if(!0!==r[0].start)for(let t=0;t<o.length;t+=1){let n=o.slice(t);if(n.length<l)break;let c=qt(n,r,t,o.length);if(c){if(c=Vt(c,e),i.push(c),!0===s)break t;let n=c.pointer[2];Math.abs(n-1)>t&&(t=Math.abs(n-1))}}else{let t=Nt(o,r,e);t&&i.push(t)}}return!0===r[r.length-1].end&&(i=i.filter(e=>{let n=e.pointer[0];return t[n].length===e.pointer[2]})),i=Dt(i,o),i}}},lib:{parseMatch:function(t){return this.world().methods.one.parseMatch(t)}}};const Lt={green:"#7f9c6c",red:"#914045",blue:"#6699cc",magenta:"#6D5685",cyan:"#2D85A8",yellow:"#e6d7b3",black:"#303b50"};var Mt=function(t){let e=t.world.tags;t.forEach(t=>{t.forEach(t=>{let n=Array.from(t.tags),r=t.text||"-";t.implicit&&(r="["+t.implicit+"]");let o="'"+r+"'";o=o.padEnd(8);let s=n.find(t=>e[t]&&e[t].color),i="steelblue";e[s]&&(i=e[s].color,i=Lt[i]),console.log(`   ${o}  -  %c${n.join(", ")}`,`color: ${i||"steelblue"};`)})})};const Ut="[0m";var Wt={green:t=>"[32m"+t+Ut,red:t=>"[31m"+t+Ut,blue:t=>"[34m"+t+Ut,magenta:t=>"[35m"+t+Ut,cyan:t=>"[36m"+t+Ut,yellow:t=>"[33m"+t+Ut,black:t=>"[30m"+t+Ut,dim:t=>"[2m"+t+Ut,i:t=>"[3m"+t+Ut},Zt=function(t){let{docs:e,model:n}=t;0===e.length&&console.log(Wt.blue("\n     ──────")),e.forEach(t=>{console.log(Wt.blue("\n  ┌─────────")),t.forEach(t=>{let e=[...t.tags||[]],r=t.text||"-";t.sense&&(r="{"+t.sense+"}"),t.implicit&&(r="["+t.implicit+"]"),void 0!==typeof module&&(r=Wt.yellow(r));let o="'"+r+"'";o=o.padEnd(18);let s=Wt.blue("  │ ")+Wt.i(o)+"  - "+function(t,e){return e.one.tagSet&&(t=t.map(t=>{if(!e.one.tagSet.hasOwnProperty(t))return t;const n=e.one.tagSet[t].color||"blue";return Wt[n](t)})),t.join(", ")}(e,n);console.log(s)})})},Qt=function(t){let{docs:e}=t;console.log(""),e.forEach(t=>{let e=[];t.forEach(t=>{"Noun"===t.chunk?e.push(Wt.blue(t.implicit||t.normal)):"Verb"===t.chunk?e.push(Wt.green(t.implicit||t.normal)):"Adjective"===t.chunk?e.push(Wt.yellow(t.implicit||t.normal)):"Pivot"===t.chunk?e.push(Wt.red(t.implicit||t.normal)):e.push(t.implicit||t.normal)}),console.log(e.join(" "),"\n")})},Ht=function(t){if(!t.found)return;let e={};t.fullPointer.forEach(t=>{e[t[0]]=e[t[0]]||[],e[t[0]].push(t)}),Object.keys(e).forEach(n=>{let r=t.update([[Number(n)]]).text();t.update(e[n]).json({offset:!0}).forEach((t,e)=>{r=function(t,e,n){let r=((t,e,n)=>{let r=9*n,o=e.start+r,s=o+e.length;return[t.substring(0,o),t.substring(o,s),t.substring(s,t.length)]})(t,e,n);return`${r[0]}${Wt.blue(r[1])}${r[2]}`}(r,t.offset,e)}),console.log(r)})};const Rt=/[,:;)\]*.?~!\u0022\uFF02\u201D\u2019\u00BB\u203A\u2032\u2033\u2034\u301E\u00B4—-]+$/,It=/^[(['"*~\uFF02\u201C\u2018\u201F\u201B\u201E\u2E42\u201A\u00AB\u2039\u2035\u2036\u2037\u301D\u0060\u301F]+/,Jt=/[,:;)('"]/,Kt=/^[-–—]$/,Xt=function(t,e,n=!0){let r="";return t.forEach(t=>{let n=t.pre||"",o=t.post||"";"some"===e.punctuation&&(n=n.replace(It,""),Kt.test(o)&&(o=" "),o=o.replace(Jt,"")),"some"===e.whitespcae&&(n=n.replace(/\s/,""),o=o.replace(/\s+/," ")),e.keepPunct||(n=n.replace(It,""),o="-"===o?" ":o.replace(Rt,""));let s=t[e.use||"text"]||t.normal||"";r+=n+s+o}),!1===n&&(r=r.trim()),!0===e.lowerCase&&(r=r.toLowerCase()),r},Yt={text:!0,terms:!0};var te=function(t,e){return"string"==typeof(e=e||{})&&(e={}),(e=Object.assign({},Yt,e)).offset&&t.compute("offset"),t.docs.map((n,r)=>{let o={};if(e.text&&(o.text=Xt(n,{keepPunct:!0},!1)),(e.normal||e.machine||e.reduced)&&(o.normal=Xt(n,{use:"normal",punctuation:"some"},!1)),e.terms&&(o.terms=function(t){return t.map(t=>{let e=Object.assign({},t);return e.tags=Array.from(t.tags),e})}(n)),e.offset){let t=o.text.length;o.offset={index:n[0].offset.index,start:n[0].offset.start,length:t}}return e.confidence&&t.confidence&&(o.confidence=t.eq(r).confidence()),e.syllables&&t.syllables&&(o.syllables=t.syllables()),o})};const ee={json:function(t){let e=te(this,t);return"number"==typeof t?e[t]:e},debug:function(t={}){let e=this;if("string"==typeof t){let e={};e[t]=!0,t=e}return"undefined"!=typeof window&&window.document?(Mt(e),e):(!1!==t.tags&&(Zt(e),console.log("\n")),!0===t.chunks&&(Qt(e),console.log("\n")),!0===t.highlight&&(Ht(e),console.log("\n")),e)},out:function(t){if("text"===t)return this.text();if("normal"===t)return this.text("normal");if("machine"===t||"reduced"===t)return this.text("machine");if("json"===t)return this.json();if("offset"===t||"offsets"===t)return this.compute("offset"),this.json({offset:!0});if("array"===t)return this.docs.map(t=>t.reduce((t,e)=>t+e.pre+e.text+e.post,"").trim()).filter(t=>t);if("freq"===t||"frequency"===t||"topk"===t)return this.compute("freq").terms().unique().termList().sort((t,e)=>t.freq>e.freq?-1:0);if("terms"===t){let t=[];return this.docs.forEach(e=>{let n=e.terms.map(t=>t.text);n=n.filter(t=>t),t=t.concat(n)}),t}return"tags"===t?this.docs.map(t=>t.reduce((t,e)=>(t[e.implicit||e.normal]=Array.from(e.tags),t),{})):"debug"===t?this.debug():this.text()}};ee.data=ee.json;var ne=ee;const re={text:{use:"text"},normal:{whitespace:"some",punctuation:"some",case:"some",unicode:"some",use:"normal"},machine:{whitespace:"some",punctuation:"some",case:"none",unicode:"some",use:"machine"},root:{whitespace:"some",punctuation:"some",case:"some",unicode:"some",use:"root"}};re.clean=re.normal,re.reduced=re.root,re.implicit=re.machine;var oe={text:function(t){let e={keepSpace:!0,keepPunct:!0};var n;if(t&&"string"==typeof t&&re.hasOwnProperty(t)?e=Object.assign({},re[t]):t&&(n=t,"[object Object]"===Object.prototype.toString.call(n))&&(e=Object.assign({},t,e)),this.pointer){e.keepSpace=!1;let t=this.pointer[0];t&&t[1]?e.keepPunct=!1:e.keepPunct=!0}return function(t,e){let n="";for(let r=0;r<t.length;r+=1)n+=Xt(t[r],e,!0);return e.keepSpace||(n=n.trim()),!1===e.keepPunct&&(n=n.replace(It,""),n=n.replace(Rt,"")),!0===e.cleanWhitespace&&(n=n.trim()),n}(this.docs,e)}};const se=Object.assign({},ne,oe);var ie={api:function(t){Object.assign(t.prototype,se)}};const le=function(t,e){if(t[0]!==e[0])return!1;let[,n,r]=t,[,o,s]=e;return n<=o&&r>o||o<=n&&s>n},ce=function(t){let e=t[0][1],n=t[0][2];return t.forEach(t=>{t[1]<e&&(e=t[1]),t[2]>n&&(n=t[2])}),[t[0][0],e,n]},ue=function(t){let e={};return t.forEach(t=>{e[t[0]]=e[t[0]]||[],e[t[0]].push(t)}),e};var ae=function(t,e){let n=ue(e),r=[];return t.forEach(t=>{let[e]=t,o=n[e]||[];if(o=o.filter(e=>function(t,e){return t[1]<=e[1]&&e[2]<=t[2]}(t,e)),0===o.length)return void r.push({passthrough:t});o=o.sort((t,e)=>t[1]-e[1]);let s=t;o.forEach((t,e)=>{let n=function(t,e){let[n,r]=t,o=e[1],s=e[2],i={};if(r<o){let e=o<t[2]?o:t[2];i.before=[n,r,e]}return i.match=e,t[2]>s&&(i.after=[n,s,t[2]]),i}(s,t);o[e+1]?(r.push({before:n.before,match:n.match}),n.after&&(s=n.after)):r.push(n)})}),r},he={one:{termList:function(t){let e=[];for(let n=0;n<t.length;n+=1)for(let r=0;r<t[n].length;r+=1)e.push(t[n][r]);return e},getDoc:function(t,e){let n=[];return t.forEach(t=>{if(!t)return;let[r,o,s]=t,i=e[r]||[];void 0===o&&(o=0),void 0===s&&(s=i.length),i=i.slice(o,s),i.length>0&&n.push(i)}),n},getUnion:function(t,e){let n=t.concat(e),r=ue(n),o=[];return n.forEach(t=>{let[e]=t;if(1===r[e].length)return void o.push(t);let n=r[e].filter(e=>le(t,e));n.push(t);let s=ce(n);o.push(s)}),o=function(t){let e={};for(let n=0;n<t.length;n+=1)e[t[n].join(",")]=t[n];return Object.values(e)}(o),o},getIntersection:function(t,e){let n=ue(e),r=[];return t.forEach(t=>{let e=n[t[0]]||[];if(e=e.filter(e=>le(t,e)),0===e.length)return;e=ce(e);let o=function(t,e){let n=t[1]<e[1]?e[1]:t[1],r=t[2]>e[2]?e[2]:t[2];return n<r?[t[0],n,r]:null}(t,e);o&&r.push(o)}),r},getDifference:function(t,e){let n=[];return ae(t,e).forEach(t=>{t.passthrough&&n.push(t.passthrough),t.before&&n.push(t.before),t.after&&n.push(t.after)}),n},indexN:ue,doesOverlap:le,splitAll:ae,pointerFromTerms:function(t){let e=[];return t.forEach(t=>{let[n,r]=t[0].index,[o,s]=t[t.length-1].index;e.push([n,r,s+1])}),e}}};const fe=(t,e)=>"string"==typeof t?e.match(t):t,pe={union:function(t){const{getUnion:e}=this.methods.one;t=fe(t,this);let n=e(this.fullPointer,t.fullPointer);return this.toView(n)}};pe.and=pe.union,pe.intersection=function(t){const{getIntersection:e}=this.methods.one;t=fe(t,this);let n=e(this.fullPointer,t.fullPointer);return this.toView(n)},pe.difference=function(t){const{getDifference:e}=this.methods.one;t=fe(t,this);let n=e(this.fullPointer,t.fullPointer);return this.toView(n)},pe.not=pe.difference,pe.complement=function(){const{getDifference:t}=this.methods.one;let e=t(this.all().fullPointer,this.fullPointer);return this.toView(e)},pe.settle=function(){const{getUnion:t}=this.methods.one;let e=this.fullPointer;return e.forEach(n=>{e=t(e,[n])}),this.update(e)};var de=pe,ge={methods:he,api:function(t){Object.assign(t.prototype,de)}};const me=/ /,ye=function(t,e){"Noun"===e&&(t.chunk=e),"Verb"===e&&(t.chunk=e)},be=function(t,e,n,r){if(!0===t.tags.has(e))return null;if("."===e)return null;let o=n[e];if(o){if(o.not&&o.not.length>0)for(let e=0;e<o.not.length;e+=1){if(!0===r&&t.tags.has(o.not[e]))return null;t.tags.delete(o.not[e])}if(o.parents&&o.parents.length>0)for(let e=0;e<o.parents.length;e+=1)t.tags.add(o.parents[e]),ye(t,o.parents[e])}return t.tags.add(e),ye(t,e),!0},we=function(t,e,n={},r){const o=n.model.one.tagSet||{};var s;if(e)if(1!=(s=e,"[object Array]"===Object.prototype.toString.call(s)))if(e=e.trim(),me.test(e))!function(t,e,n,r){let o=e.split(me);t.forEach((t,e)=>{let s=o[e];s&&(s=s.replace(/^#/,""),be(t,s,n,r))})}(t,e,o,r);else{e=e.replace(/^#/,"");for(let n=0;n<t.length;n+=1)be(t[n],e,o,r)}else e.forEach(e=>we(t,e,n,r))};var ve=we,xe=function(t,e,n){e=e.trim().replace(/^#/,"");for(let r=0;r<t.length;r+=1){let o=t[r];if("*"===e){o.tags.clear();continue}let s=n[e];if(s&&s.children.length>0)for(let t=0;t<s.children.length;t+=1)o.tags.delete(s.children[t]);o.tags.delete(e)}};const je=function(t){return t.children=t.children||[],t._cache=t._cache||{},t.props=t.props||{},t._cache.parents=t._cache.parents||[],t._cache.children=t._cache.children||[],t},Ee=/^ *(#|\/\/)/,Oe=function(t){let e=t.trim().split(/->/),n=[];e.forEach(t=>{n=n.concat(function(t){if(!(t=t.trim()))return null;if(/^\[/.test(t)&&/\]$/.test(t)){let e=(t=(t=t.replace(/^\[/,"")).replace(/\]$/,"")).split(/,/);return e=e.map(t=>t.trim()).filter(t=>t),e=e.map(t=>je({id:t})),e}return[je({id:t})]}(t))}),n=n.filter(t=>t);let r=n[0];for(let t=1;t<n.length;t+=1)r.children.push(n[t]),r=n[t];return n[0]},_e=(t,e)=>{let n=[],r=[t];for(;r.length>0;){let t=r.pop();n.push(t),t.children&&t.children.forEach(n=>{e&&e(t,n),r.push(n)})}return n},ke=t=>"[object Array]"===Object.prototype.toString.call(t),Pe=t=>(t=t||"").trim(),Ae=function(t=[]){return"string"==typeof t?function(t){let e=t.split(/\r?\n/),n=[];e.forEach(t=>{if(!t.trim()||Ee.test(t))return;let e=(t=>{const e=/^( {2}|\t)/;let n=0;for(;e.test(t);)t=t.replace(e,""),n+=1;return n})(t);n.push({indent:e,node:Oe(t)})});let r=function(t){let e={children:[]};return t.forEach((n,r)=>{0===n.indent?e.children=e.children.concat(n.node):t[r-1]&&function(t,e){let n=t[e].indent;for(;e>=0;e-=1)if(t[e].indent<n)return t[e];return t[0]}(t,r).node.children.push(n.node)}),e}(n);return r=je(r),r}(t):ke(t)?function(t){let e={};t.forEach(t=>{e[t.id]=t});let n=je({});return t.forEach(t=>{if((t=je(t)).parent)if(e.hasOwnProperty(t.parent)){let n=e[t.parent];delete t.parent,n.children.push(t)}else console.warn(`[Grad] - missing node '${t.parent}'`);else n.children.push(t)}),n}(t):(_e(e=t).forEach(je),e);var e},ze=function(t,e){let n="-> ";e&&(n=(t=>"[2m"+t+"[0m")("→ "));let r="";return _e(t).forEach((t,o)=>{let s=t.id||"";if(e&&(s=(t=>"[31m"+t+"[0m")(s)),0===o&&!t.id)return;let i=t._cache.parents.length;r+="    ".repeat(i)+n+s+"\n"}),r},Se=function(t){let e=_e(t);e.forEach(t=>{delete(t=Object.assign({},t)).children});let n=e[0];return n&&!n.id&&0===Object.keys(n.props).length&&e.shift(),e},Ce={text:ze,txt:ze,array:Se,flat:Se},$e=function(t,e){return"nested"===e||"json"===e?t:"debug"===e?(console.log(ze(t,!0)),null):Ce.hasOwnProperty(e)?Ce[e](t):t},Fe=t=>{_e(t,(t,e)=>{t.id&&(t._cache.parents=t._cache.parents||[],e._cache.parents=t._cache.parents.concat([t.id]))})},Te=/\//;class g{constructor(t={}){Object.defineProperty(this,"json",{enumerable:!1,value:t,writable:!0})}get children(){return this.json.children}get id(){return this.json.id}get found(){return this.json.id||this.json.children.length>0}props(t={}){let e=this.json.props||{};return"string"==typeof t&&(e[t]=!0),this.json.props=Object.assign(e,t),this}get(t){if(t=Pe(t),!Te.test(t)){let e=this.json.children.find(e=>e.id===t);return new g(e)}let e=((t,e)=>{let n=(t=>"string"!=typeof t?t:(t=t.replace(/^\//,"")).split(/\//))(e=e||"");for(let e=0;e<n.length;e+=1){let r=t.children.find(t=>t.id===n[e]);if(!r)return null;t=r}return t})(this.json,t)||je({});return new g(e)}add(t,e={}){if(ke(t))return t.forEach(t=>this.add(Pe(t),e)),this;t=Pe(t);let n=je({id:t,props:e});return this.json.children.push(n),new g(n)}remove(t){return t=Pe(t),this.json.children=this.json.children.filter(e=>e.id!==t),this}nodes(){return _e(this.json).map(t=>(delete(t=Object.assign({},t)).children,t))}cache(){return(t=>{let e=_e(t,(t,e)=>{t.id&&(t._cache.parents=t._cache.parents||[],t._cache.children=t._cache.children||[],e._cache.parents=t._cache.parents.concat([t.id]))}),n={};e.forEach(t=>{t.id&&(n[t.id]=t)}),e.forEach(t=>{t._cache.parents.forEach(e=>{n.hasOwnProperty(e)&&n[e]._cache.children.push(t.id)})}),t._cache.children=Object.keys(n)})(this.json),this}list(){return _e(this.json)}fillDown(){var t;return t=this.json,_e(t,(t,e)=>{e.props=((t,e)=>(Object.keys(e).forEach(n=>{if(e[n]instanceof Set){let r=t[n]||new Set;t[n]=new Set([...r,...e[n]])}else if((t=>t&&"object"==typeof t&&!Array.isArray(t))(e[n])){let r=t[n]||{};t[n]=Object.assign({},e[n],r)}else ke(e[n])?t[n]=e[n].concat(t[n]||[]):void 0===t[n]&&(t[n]=e[n])}),t))(e.props,t.props)}),this}depth(){Fe(this.json);let t=_e(this.json),e=t.length>1?1:0;return t.forEach(t=>{if(0===t._cache.parents.length)return;let n=t._cache.parents.length+1;n>e&&(e=n)}),e}out(t){return Fe(this.json),$e(this.json,t)}debug(){return Fe(this.json),$e(this.json,"debug"),this}}const Be=function(t){let e=Ae(t);return new g(e)};Be.prototype.plugin=function(t){t(this)};var qe={Noun:"blue",Verb:"green",Negative:"green",Date:"red",Value:"red",Adjective:"magenta",Preposition:"cyan",Conjunction:"cyan",Determiner:"cyan",Adverb:"cyan"};const De=function(t){if(qe.hasOwnProperty(t.id))return qe[t.id];if(qe.hasOwnProperty(t.is))return qe[t.is];let e=t._cache.parents.find(t=>qe[t]);return qe[e]};var Ve=function(t){const e={};return t.forEach(t=>{let{not:n,also:r,is:o}=t.props,s=t._cache.parents;r&&(s=s.concat(r)),e[t.id]={is:o,not:n,parents:s,children:t._cache.children,color:De(t)}}),Object.keys(e).forEach(t=>{let n=new Set(e[t].not);e[t].not.forEach(t=>{e[t].children.forEach(t=>n.add(t))}),e[t].not=Array.from(n)}),e};const Ne=function(t){return t?"string"==typeof t?[t]:t:[]};var Ge=function(t,e){return t=function(t,e){return Object.keys(t).forEach(n=>{t[n].isA&&(t[n].is=t[n].isA),t[n].notA&&(t[n].not=t[n].notA),t[n].is&&"string"==typeof t[n].is&&(e.hasOwnProperty(t[n].is)||t.hasOwnProperty(t[n].is)||(t[t[n].is]={})),t[n].not&&"string"==typeof t[n].not&&!t.hasOwnProperty(t[n].not)&&(e.hasOwnProperty(t[n].not)||t.hasOwnProperty(t[n].not)||(t[t[n].not]={}))}),t}(t,e),Object.keys(t).forEach(e=>{t[e].children=Ne(t[e].children),t[e].not=Ne(t[e].not)}),Object.keys(t).forEach(e=>{(t[e].not||[]).forEach(n=>{t[n]&&t[n].not&&t[n].not.push(e)})}),t};const Le=function(t){return"[object Array]"===Object.prototype.toString.call(t)};var Me={tag:function(t,e="",n){if(!this.found||!t)return this;let r=this.termList();if(0===r.length)return this;const{methods:o,verbose:s,world:i}=this;return!0===s&&console.log(" +  ",t,e||""),Le(t)?t.forEach(t=>o.one.setTag(r,t,i,n)):o.one.setTag(r,t,i,n),this.uncache(),this},tagSafe:function(t,e=""){return this.tag(t,e,!0)},unTag:function(t,e){if(!this.found||!t)return this;let n=this.termList();if(0===n.length)return this;const{methods:r,verbose:o,model:s}=this;!0===o&&console.log(" -  ",t,e||"");let i=s.one.tagSet;return Le(t)?t.forEach(t=>r.one.unTag(n,t,i)):r.one.unTag(n,t,i),this.uncache(),this},canBe:function(t){let e=this.model.one.tagSet;if(!e.hasOwnProperty(t))return this;let n=e[t].not||[],r=[];this.document.forEach((t,e)=>{t.forEach((t,o)=>{n.find(e=>t.tags.has(e))&&r.push([e,o,o+1])})});let o=this.update(r);return this.difference(o)}},Ue={model:{one:{tagSet:{}}},methods:{one:{setTag:ve,unTag:xe,addTags:function(t,e){t=Ge(t,e);const n=function(t){const e=Object.keys(t).map(e=>{let n=t[e];const r={not:new Set(n.not),also:n.also,is:n.is};return{id:e,parent:n.is,props:r,children:[]}});return Be(e).cache().fillDown().out("array")}(Object.assign({},e,t));return Ve(n)}}},api:function(t){Object.assign(t.prototype,Me)},lib:{addTags:function(t){const{model:e,methods:n}=this.world(),r=e.one.tagSet;let o=(0,n.one.addTags)(t,r);return e.one.tagSet=o,this}}};const We=/(\S.+?[.!?\u203D\u2E18\u203C\u2047-\u2049])(?=\s|$)/g,Ze=/((?:\r?\n|\r)+)/;var Qe=function(t){let e=[],n=t.split(Ze);for(let t=0;t<n.length;t++){let r=n[t].split(We);for(let t=0;t<r.length;t++)e.push(r[t])}return e};const He=/[ .][A-Z]\.? *$/i,Re=/(?:\u2026|\.{2,}) *$/,Ie=/[a-z0-9\u00C0-\u00FF\u00a9\u00ae\u2000-\u3300\ud000-\udfff]/i;var Je=function(t,e){if(!1===Ie.test(t))return!1;if(!0===He.test(t))return!1;if(!0===Re.test(t))return!1;let n=t.replace(/[.!?\u203D\u2E18\u203C\u2047-\u2049] *$/,"").split(" "),r=n[n.length-1].toLowerCase();return!0!==e.hasOwnProperty(r)};const Ke=/\S/,Xe=/^\s+/,Ye=/[a-z0-9\u00C0-\u00FF\u00a9\u00ae\u2000-\u3300\ud000-\udfff]/i;var tn=function(t,e){let n=e.one.abbreviations||new Set;t=t||"";let r=[],o=[];if(!(t=String(t))||"string"!=typeof t||!1===Ke.test(t))return r;t=t.replace(" "," ");let s=Qe(t);for(let t=0;t<s.length;t++){let e=s[t];if(void 0!==e&&""!==e){if(!1===Ke.test(e)||!1===Ye.test(e)){if(o[o.length-1]){o[o.length-1]+=e;continue}if(s[t+1]){s[t+1]=e+s[t+1];continue}}o.push(e)}}for(let t=0;t<o.length;t++){let e=o[t];o[t+1]&&!1===Je(e,n,Ye)?o[t+1]=e+(o[t+1]||""):e&&e.length>0&&(r.push(e),o[t]="")}if(0===r.length)return[t];for(let t=1;t<r.length;t+=1){let e=r[t].match(Xe);null!==e&&(r[t-1]+=e[0],r[t]=r[t].replace(Xe,""))}return r};const en=function(t,e){let n=t.split(/[-–—]/);if(n.length<=1)return!1;const{prefixes:r,suffixes:o}=e.one;return!r.hasOwnProperty(n[0])&&(n[1]=n[1].trim().replace(/[.?!]$/,""),!o.hasOwnProperty(n[1])&&(!0===/^([a-z\u00C0-\u00FF`"'/]+)[-–—]([a-z0-9\u00C0-\u00FF].*)/i.test(t)||!0===/^([0-9]{1,4})[-–—]([a-z\u00C0-\u00FF`"'/-]+$)/i.test(t)))},nn=function(t){let e=[];const n=t.split(/[-–—]/);let r="-",o=t.match(/[-–—]/);o&&o[0]&&(r=o);for(let t=0;t<n.length;t++)t===n.length-1?e.push(n[t]):e.push(n[t]+r);return e};var rn=function(t){const e=/^[0-9]{1,4}(:[0-9][0-9])?([a-z]{1,2})? ?[-–—] ?$/,n=/^[0-9]{1,4}([a-z]{1,2})? ?$/;for(let r=0;r<t.length-1;r+=1)t[r+1]&&e.test(t[r])&&n.test(t[r+1])&&(t[r]=t[r]+t[r+1],t[r+1]=null);return t};const on=/[a-z] ?\/ ?[a-z]+$/;var sn=function(t){for(let e=1;e<t.length-1;e++)on.test(t[e])&&(t[e-1]+=t[e]+t[e+1],t[e]=null,t[e+1]=null);return t};const ln=/\S/,cn=/^[!?.]+$/,un=/(\S+)/;let an=[".","?","!",":",";","-","–","—","--","...","(",")","[","]",'"',"'","`"];an=an.reduce((t,e)=>(t[e]=!0,t),{});var hn=function(t,e){let n=[],r=[];if("number"==typeof(t=t||"")&&(t=String(t)),function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t))return t;const o=t.split(un);for(let t=0;t<o.length;t++)!0!==en(o[t],e)?r.push(o[t]):r=r.concat(nn(o[t]));let s="";for(let t=0;t<r.length;t++){let e=r[t];!0===ln.test(e)&&!1===an.hasOwnProperty(e)&&!1===cn.test(e)?(n.length>0?(n[n.length-1]+=s,n.push(e)):n.push(s+e),s=""):s+=e}return s&&(0===n.length&&(n[0]=""),n[n.length-1]+=s),n=sn(n),n=rn(n),n=n.filter(t=>t),n};const fn=/^[ \n\t.[\](){}⟨⟩:,،、‒–—―…!‹›«»‐\-?‘’;/⁄·&*•^†‡°¡¿※№÷×ºª%‰+−=‱¶′″‴§~|‖¦©℗®℠™¤₳฿\u0022\uFF02\u0027\u201C\u201F\u201B\u201E\u2E42\u201A\u2035\u2036\u2037\u301D\u0060\u301F]+/,pn=/[ \n\t.'[\](){}⟨⟩:,،、‒–—―…!‹›«»‐\-?‘’;/⁄·&*@•^†‡°¡¿※#№÷×ºª‰+−=‱¶′″‴§~|‖¦©℗®℠™¤₳฿\u0022\uFF02\u201D\u00B4\u301E]+$/,dn=/['’]/,gn=/^[a-z]\.([a-z]\.)+/i,mn=/^[-+.][0-9]/,yn=/^'[0-9]{2}/;var bn=function(t){let e=t,n="",r="";return""===(t=(t=t.replace(fn,e=>(n=e,"-"!==n&&"+"!==n&&"."!==n||!mn.test(t)?"'"===n&&yn.test(t)?(n="",e):"":(n="",e)))).replace(pn,o=>(r=o,dn.test(o)&&/[sn]['’]$/.test(e)&&!1===dn.test(n)?(r=r.replace(dn,""),"'"):!0===gn.test(t)?(r=r.replace(/\./,""),"."):"")))&&(e=e.replace(/ *$/,t=>(r=t||"","")),t=e,n=""),{str:t,pre:n,post:r}},wn=t=>{let{str:e,pre:n,post:r}=bn(t);return{text:e,pre:n,post:r,tags:new Set}},vn=function(t){let e=t=(t=(t=t||"").toLowerCase()).trim();return t=(t=(t=(t=(t=t.replace(/[,;.!?]+$/,"")).replace(/[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]+/g,"'")).replace(/[\u0022\u00AB\u00BB\u201C\u201D\u201E\u201F\u2033\u2034\u2036\u2037\u2E42\u301D\u301E\u301F\uFF02]+/g,'"')).replace(/\u2026/g,"...")).replace(/\u2013/g,"-"),!1===/^[:;]/.test(t)&&(t=(t=(t=t.replace(/\.{3,}$/g,"")).replace(/[",.!:;?)]+$/g,"")).replace(/^['"(]+/g,"")),""===(t=(t=t.replace(/[\u200B-\u200D\uFEFF]/g,"")).trim())&&(t=e),t=t.replace(/([0-9]),([0-9])/g,"$1$2")};let xn={"!":"¡","?":"¿Ɂ",'"':'“”"❝❞',"'":"‘‛❛❜","-":"—–",a:"ªÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧȺΆΑΔΛάαλАаѦѧӐӑӒӓƛæ",b:"ßþƀƁƂƃƄƅɃΒβϐϦБВЪЬвъьѢѣҌҍ",c:"¢©ÇçĆćĈĉĊċČčƆƇƈȻȼͻͼϲϹϽϾСсєҀҁҪҫ",d:"ÐĎďĐđƉƊȡƋƌ",e:"ÈÉÊËèéêëĒēĔĕĖėĘęĚěƐȄȅȆȇȨȩɆɇΈΕΞΣέεξϵЀЁЕеѐёҼҽҾҿӖӗ",f:"ƑƒϜϝӺӻҒғſ",g:"ĜĝĞğĠġĢģƓǤǥǦǧǴǵ",h:"ĤĥĦħƕǶȞȟΉΗЂЊЋНнђћҢңҤҥҺһӉӊ",I:"ÌÍÎÏ",i:"ìíîïĨĩĪīĬĭĮįİıƖƗȈȉȊȋΊΐΪίιϊІЇії",j:"ĴĵǰȷɈɉϳЈј",k:"ĶķĸƘƙǨǩΚκЌЖКжкќҚқҜҝҞҟҠҡ",l:"ĹĺĻļĽľĿŀŁłƚƪǀǏǐȴȽΙӀӏ",m:"ΜϺϻМмӍӎ",n:"ÑñŃńŅņŇňŉŊŋƝƞǸǹȠȵΝΠήηϞЍИЙЛПийлпѝҊҋӅӆӢӣӤӥπ",o:"ÒÓÔÕÖØðòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱΌΘΟθοσόϕϘϙϬϴОФоѲѳӦӧӨөӪӫ",p:"ƤΡρϷϸϼРрҎҏÞ",q:"Ɋɋ",r:"ŔŕŖŗŘřƦȐȑȒȓɌɍЃГЯгяѓҐґ",s:"ŚśŜŝŞşŠšƧƨȘșȿЅѕ",t:"ŢţŤťŦŧƫƬƭƮȚțȶȾΓΤτϮТт",u:"µÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưƱƲǓǔǕǖǗǘǙǚǛǜȔȕȖȗɄΰμυϋύ",v:"νѴѵѶѷ",w:"ŴŵƜωώϖϢϣШЩшщѡѿ",x:"×ΧχϗϰХхҲҳӼӽӾӿ",y:"ÝýÿŶŷŸƳƴȲȳɎɏΎΥΫγψϒϓϔЎУучўѰѱҮүҰұӮӯӰӱӲӳ",z:"ŹźŻżŽžƵƶȤȥɀΖ"},jn={};Object.keys(xn).forEach((function(t){xn[t].split("").forEach((function(e){jn[e]=t}))}));var En=t=>{let e=t.split("");return e.forEach((t,n)=>{jn[t]&&(e[n]=jn[t])}),e.join("")};const On=/([A-Z]\.)+[A-Z]?,?$/,_n=/^[A-Z]\.,?$/,kn=/[A-Z]{2,}('s|,)?$/,Pn=/([a-z]\.)+[a-z]\.?$/;var An=function(t){return function(t){return!0===On.test(t)||!0===Pn.test(t)||!0===_n.test(t)||!0===kn.test(t)}(t)&&(t=t.replace(/\./g,"")),t},zn=function(t){let e=t.text||"";e=vn(e),e=En(e),e=An(e),t.normal=e},Sn={one:{splitSentences:tn,splitTerms:hn,splitWhitespace:wn,tokenize:function(t,e){const{methods:n,model:r,compute:o}=e,{splitSentences:s,splitTerms:i,splitWhitespace:l}=n.one;return"number"==typeof(t=t||"")&&(t=String(t)),"string"==typeof t&&(t=s(t,r).map(t=>{let e=i(t,r);return e=e.map(l),e.forEach(zn),e})),t}}},Cn={"&":"and","@":"at","%":"percent"};let $n={},Fn={};[[["approx","apt","bc","cyn","eg","esp","est","etc","ex","exp","prob","pron","gal","min","pseud","fig","jd","lat","lng","vol","fm","def","misc","plz","ea","ps","sec","pt","pref","pl","pp","qt","fr","sq","nee","ss","tel","temp","vet","ver","fem","masc","eng","adj","vb","rb","inf","situ","vivo","vitro","wr"]],[["dl","ml","gal","ft","qt","pt","tbl","tsp","tbsp","km","dm","cm","mm","mi","td","hr","hrs","kg","hg","dg","cg","mg","µg","lb","oz","sq ft","hz","mps","mph","kmph","kb","mb","gb","tb","lx","lm","pa","fl oz","yb"],"Unit"],[["ad","al","arc","ba","bl","ca","cca","col","corp","ft","fy","ie","lit","ma","md","pd","tce"],"Noun"],[["adj","adm","adv","asst","atty","bldg","brig","capt","cmdr","comdr","cpl","det","dr","esq","gen","gov","hon","jr","llb","lt","maj","messrs","mister","mlle","mme","mr","mrs","ms","mstr","phd","prof","pvt","rep","reps","res","rev","sen","sens","sfc","sgt","sir","sr","supt","surg"],"Honorific"],[["jan","feb","mar","apr","jun","jul","aug","sep","sept","oct","nov","dec"],"Month"],[["dept","univ","assn","bros","inc","ltd","co"],"Organization"],[["rd","st","dist","mt","ave","blvd","cl","cres","hwy","ariz","cal","calif","colo","conn","fla","fl","ga","ida","ia","kan","kans","minn","neb","nebr","okla","penna","penn","pa","dak","tenn","tex","ut","vt","va","wis","wisc","wy","wyo","usafa","alta","ont","que","sask"],"Place"]].forEach(t=>{t[0].forEach(e=>{$n[e]=!0,Fn[e]="Abbreviation",void 0!==t[1]&&(Fn[e]=[Fn[e],t[1]])})});var Tn=["anti","bi","co","contra","counter","de","extra","infra","inter","intra","macro","micro","mid","mis","mono","multi","non","over","peri","post","pre","pro","proto","pseudo","re","semi","sub","supra","trans","tri","un","out"].reduce((t,e)=>(t[e]=!0,t),{});const Bn=/\//,qn=/[a-z]\.[a-z]/i,Dn=/[0-9]/;var Vn=function(t,e){let n=t.normal||t.text;const r=e.model.one.aliases;if(r.hasOwnProperty(n)&&(t.alias=t.alias||[],t.alias.push(r[n])),Bn.test(n)&&!qn.test(n)&&!Dn.test(n)){let e=n.split(Bn);e.length<=2&&e.forEach(e=>{""!==(e=e.trim())&&(t.alias=t.alias||[],t.alias.push(e))})}return t},Nn=function(t){let e=t.implicit||t.normal||t.text;e=e.replace(/['’]s$/,""),e=e.replace(/s['’]$/,"s"),e=e.replace(/([aeiou][ktrp])in$/,"$1ing"),!0===/^(re|un)-?[^aeiou]./.test(e)&&(e=e.replace("-","")),e=e.replace(/^[#@]/,""),e!==t.normal&&(t.machine=e)},Gn=function(t){let e=0,n=0,r=t.document;for(let t=0;t<r.length;t+=1)for(let o=0;o<r[t].length;o+=1){let s=r[t][o];s.offset={index:n,start:e+s.pre.length,length:s.text.length},e+=s.pre.length+s.text.length+s.post.length,n+=1}};const Ln=function(t,e){let n=t.docs;for(let r=0;r<n.length;r+=1)for(let o=0;o<n[r].length;o+=1)e(n[r][o],t.world)};var Mn={compute:{alias:t=>Ln(t,Vn),normal:t=>Ln(t,zn),machine:t=>Ln(t,Nn),freq:function(t){let e=t.docs,n={};for(let t=0;t<e.length;t+=1)for(let r=0;r<e[t].length;r+=1){let o=e[t][r],s=o.machine||o.normal;n[s]=n[s]||0,n[s]+=1}for(let t=0;t<e.length;t+=1)for(let r=0;r<e[t].length;r+=1){let o=e[t][r],s=o.machine||o.normal;o.freq=n[s]}},offset:Gn,index:function(t){let e=t.document;for(let t=0;t<e.length;t+=1)for(let n=0;n<e[t].length;n+=1)e[t][n].index=[t,n]},wordCount:function(t){let e=0,n=t.docs;for(let t=0;t<n.length;t+=1)for(let r=0;r<n[t].length;r+=1)""!==n[t][r].normal&&(e+=1,n[t][r].wordCount=e)}},methods:Sn,model:{one:{aliases:Cn,abbreviations:$n,prefixes:Tn,suffixes:{like:!0,ish:!0,less:!0,able:!0,elect:!0,type:!0,designate:!0},lexicon:Fn}},hooks:["alias","machine","index"]},Un=function(t,e){let n=[{}],r=[null],o=[0],s=[],i=0;t.forEach((function(t){let o=0,s=function(t,e){const{methods:n,model:r}=e;return n.one.splitTerms(t,r).map(n.one.splitWhitespace).map(t=>t.text.toLowerCase())}(t,e);for(let t=0;t<s.length;t++){let e=s[t];n[o]&&n[o].hasOwnProperty(e)?o=n[o][e]:(i++,n[o][e]=i,n[i]={},o=i,r[i]=null)}r[o]=[s.length]}));for(let t in n[0])i=n[0][t],o[i]=0,s.push(i);for(;s.length;){let t=s.shift();for(let e in n[t]){let l=n[t][e];for(s.push(l),i=o[t];i>0&&!n[i].hasOwnProperty(e);)i=o[i];if(e in n[i]){let t=n[i][e];o[l]=t,r[t]&&(r[l]=r[l]||[],r[l]=r[l].concat(r[t]))}else o[l]=0}}return{goNext:n,endAs:r,failTo:o}};const Wn=(t,e)=>{for(let n=t.length-1;n>=0;n-=1)if(t[n]!==e)return t=t.slice(0,n+1);return t};var Zn=function(t){return t.goNext=t.goNext.map(t=>{if(0!==Object.keys(t).length)return t}),t.goNext=Wn(t.goNext,void 0),t.failTo=Wn(t.failTo,0),t.endAs=Wn(t.endAs,null),t};const Qn=function(t,e){let n=0,r=[];for(let o=0;o<t.length;o++){let s=t[o].normal;for(;n>0&&(void 0===e.goNext[n]||!e.goNext[n].hasOwnProperty(s));)n=e.failTo[n]||0;if(e.goNext[n].hasOwnProperty(s)&&(n=e.goNext[n][s],e.endAs[n])){let s=e.endAs[n];for(let e=0;e<s.length;e++){let n=s[e],i=t[o-n+1],[l,c]=i.index;r.push([l,c,c+n])}}}return r},Hn=function(t,e){for(let n=0;n<t.length;n+=1)if(!0===e.has(t[n]))return!1;return!0};var Rn=function(t,e){let n=[],r=t.docs,o=Object.keys(e.goNext[0]);for(let s=0;s<r.length;s++){if(t._cache&&t._cache[s]&&!0===Hn(o,t._cache[s]))continue;let i=r[s],l=Qn(i,e);l.length>0&&(n=n.concat(l))}return t.update(n)},In={api:function(t){t.prototype.compile=function(t){const e=Un(t,this.world);return Zn(e)},t.prototype.lookup=function(t){if(!t)return this.none();"string"==typeof t&&(t=[t]);let e=(n=t,"[object Object]"===Object.prototype.toString.call(n)?t:Un(t,this.world));var n;let r=Rn(this,e);return r=r.settle(),r}}};const Jn={cache:function(){return this._cache=this.methods.one.cacheDoc(this.document),this},uncache:function(){return this._cache=null,this}};var Kn={api:function(t){Object.assign(t.prototype,Jn)},compute:{cache:function(t){t._cache=t.methods.one.cacheDoc(t.document)}},methods:{one:{cacheDoc:function(t){return t.map(t=>{let e=new Set;return t.forEach(t=>{""!==t.normal&&e.add(t.normal),t.implicit&&e.add(t.implicit);let n=Array.from(t.tags);for(let t=0;t<n.length;t+=1)e.add("#"+n[t])}),e})},cacheMatch:function(t){let e=new Set;return t.forEach(t=>{!0!==t.optional&&!0!==t.negative&&(t.tag&&e.add("#"+t.tag),t.word&&e.add(t.word))}),e}}}};const Xn=function(){const t=this.docs;if(0===t.length)return;let e=t[t.length-1]||[],n=e[e.length-1];return!0===n.typeahead&&n.machine&&(n.text=n.machine,n.normal=n.machine),this};var Yn=function(t,e,n){let r={},o=[],s=n.prefixes||{};return t.forEach(t=>{let i=(t=t.toLowerCase().trim()).length;e.max&&i>e.max&&(i=e.max);for(let l=e.min;l<i;l+=1){let i=t.substr(0,l);e.safe&&n.model.one.lexicon.hasOwnProperty(i)||(!0!==s.hasOwnProperty(i)&&!0!==r.hasOwnProperty(i)?r[i]=t:o.push(i))}}),r=Object.assign({},s,r),o.forEach(t=>{delete r[t]}),r};const tr={safe:!0,min:3},er=function(t=[],e={}){let n=this.model();var r;e=Object.assign({},tr,e),r=t,"[object Object]"===Object.prototype.toString.call(r)&&(Object.assign(n.one.lexicon,t),t=Object.keys(t));let o=Yn(t,e,this.world());return Object.keys(o).forEach(t=>{n.one.typeahead.hasOwnProperty(t)?delete n.one.typeahead[t]:n.one.typeahead[t]=o[t]}),this};var nr={model:{one:{typeahead:{}}},api:function(t){t.prototype.autoFill=Xn},lib:{typeahead:er,typeAhead:er},compute:{typeahead:function(t){const e=t.model.one.typeahead,n=t.docs;if(0===n.length||0===Object.keys(e).length)return;let r=n[n.length-1]||[],o=r[r.length-1];if(!o.post&&e.hasOwnProperty(o.normal)){let n=e[o.normal];o.machine=n,o.typeahead=!0,t.compute.preTagger&&t.last().unTag("*").compute(["lexicon","preTagger"])}}},hooks:["typeahead"]},rr=function(t,e,n){const{model:r,methods:o}=n,{fastTag:s}=o.one,i=r.one._multiCache||{},l=r.one.lexicon||{};let c=t[e],u=c.machine||c.normal;return void 0!==t[e+1]&&!0===i[u]?function(t,e,n,r){let o=e+4>t.length?t.length-e:4,s=t[e].machine||t[e].normal;for(let i=1;i<o;i+=1){let o=t[e+i];if(s+=" "+(o.machine||o.normal),!0===n.hasOwnProperty(s)){let o=n[s];return t.slice(e,e+i+1).forEach(t=>r(t,o,"1-multi-lexicon")),!0}}return!1}(t,e,l,s):null};const or=/^(under|over)-?.{3}/;var sr=function(t,e,n){const{model:r,methods:o}=n,s=o.one.fastTag,i=r.one.lexicon;let l=t[e],c=l.machine||l.normal;if(void 0!==i[c]&&i.hasOwnProperty(c))return s(l,i[c],"1-lexicon"),!0;if(l.alias){let t=l.alias.find(t=>i.hasOwnProperty(t));if(t)return s(l,i[t],"1-lexicon-alias"),!0}if(!0===or.test(c)){let t=c.replace(/^(under|over)-?/,"");if(i.hasOwnProperty(t))return s(l,i[t],"1-lexicon-prefix"),!0}return null},ir={addWords:function(t){const e=this.world(),{methods:n,model:r}=e;if(t)if(Object.keys(t).forEach(e=>{"string"==typeof t[e]&&t[e].startsWith("#")&&(t[e]=t[e].replace(/^#/,""))}),n.two.expandLexicon){let{lex:o,_multi:s}=n.two.expandLexicon(t,e);Object.assign(r.one.lexicon,o),Object.assign(r.one._multiCache,s)}else if(n.one.expandLexicon){let{lex:o,_multi:s}=n.one.expandLexicon(t,e);Object.assign(r.one.lexicon,o),Object.assign(r.one._multiCache,s)}else Object.assign(r.one.lexicon,t)}},lr={model:{one:{lexicon:{},_multiCache:{}}},methods:{one:{expandLexicon:function(t,e){let n={},r={};return Object.keys(t).forEach(e=>{let o=t[e],s=(e=e.toLowerCase().trim()).split(/ /);s.length>1&&(r[s[0]]=!0),n[e]=n[e]||o}),delete n[""],delete n.null,delete n[" "],{lex:n,_multi:r}},fastTag:function(t,e,n){if(!e||0===e.length)return;let r="undefined"==typeof process?self.env||{}:process.env;r&&r.DEBUG_TAGS&&((t,e,n="")=>{let r=t.text||"["+t.implicit+"]";var o;"string"!=typeof e&&e.length>2&&(e=e.slice(0,2).join(", #")+" +"),e="string"!=typeof e?e.join(", #"):e,console.log(` ${(o=r,"[33m[3m"+o+"[0m").padEnd(24)} [32m→[0m #${e.padEnd(25)}  ${(t=>"[3m"+t+"[0m")(n)}`)})(t,e,n),t.tags=t.tags||new Set,"string"==typeof e?t.tags.add(e):e.forEach(e=>t.tags.add(e))}}},compute:{lexicon:function(t){const e=t.world;t.docs.forEach(t=>{for(let n=0;n<t.length;n+=1)if(0===t[n].tags.size){let r=null;r=r||rr(t,n,e),r=r||sr(t,n,e)}})}},lib:ir,hooks:["lexicon"]};return y.extend(V),y.extend(ie),y.extend(Gt),y.extend(ge),y.extend(Ue),y.extend(Mn),y.plugin(Kn),y.extend(In),y.extend(nr),y.extend(lr),y},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).nlp=e();
